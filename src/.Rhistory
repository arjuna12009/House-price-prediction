percent_50 <- stocks[stocks[,9]<25,]
loss <- percent_50[percent_50[,10]<25,]
loss
final_percent <- (nrow(stocks)-nrow(loss))/nrow(stocks)
final_percent
(1.25)^(nrow(stocks)*final_percent)*270
0.75^(nrow(stocks)*(1-final_percent))*270
1-final_percent
percent_50 <- stocks[stocks[,9]<25,]
loss <- percent_50[percent_50[,10]<25,]
loss
final_percent <- (nrow(stocks)-nrow(loss))/nrow(stocks)
final_percent
(1.25)^(nrow(stocks)*final_percent-(1-percent))*270
percent_50 <- stocks[stocks[,9]<25,]
loss <- percent_50[percent_50[,10]<25,]
loss
final_percent <- (nrow(stocks)-nrow(loss))/nrow(stocks)
final_percent
(1.25)^(nrow(stocks)*final_percent-(1-final_percent))*270
percent_50 <- stocks[stocks[,9]<25,]
loss <- percent_50[percent_50[,10]<25,]
loss
final_percent <- (nrow(stocks)-nrow(loss))/nrow(stocks)
final_percent-(1-final_percent)
(1.25)^(nrow(stocks)*final_percent-(1-final_percent))*270
percent_50 <- stocks[stocks[,9]<10,]
loss <- percent_50[percent_50[,10]<10,]
loss
final_percent <- (nrow(stocks)-nrow(loss))/nrow(stocks)
final_percent-(1-final_percent)
(1.25)^(nrow(stocks)*final_percent-(1-final_percent))*270
percent_50 <- stocks[stocks[,9]<10,]
loss <- percent_50[percent_50[,10]<10,]
loss
final_percent <- (nrow(stocks)-nrow(loss))/nrow(stocks)
final_percent-(1-final_percent)
(1.1)^(nrow(stocks)*final_percent-(1-final_percent))*270
percent_50 <- stocks[stocks[,9]<20,]
loss <- percent_50[percent_50[,10]<20,]
loss
final_percent <- (nrow(stocks)-nrow(loss))/nrow(stocks)
final_percent-(1-final_percent)
(1.2)^(nrow(stocks)*final_percent-(1-final_percent))*270
percent_50 <- stocks[stocks[,9]<20,]
loss <- percent_50[percent_50[,10]<20,]
loss
final_percent <- (nrow(stocks)-nrow(loss))/nrow(stocks)
final_percent-(1-final_percent)
(1.2)^(nrow(stocks)*final_percent)*270
nrow(stocks)*final_percent
seq(37,20)
?replicate
percent_50 <- stocks[stocks[,9]<20,]
loss <- percent_50[percent_50[,10]<20,]
loss
final_percent <- (nrow(stocks)-nrow(loss))/nrow(stocks)
final_percent-(1-final_percent)
(1.2)^(nrow(stocks)*final_percent)*270
replicate(37,"20")
percent_50 <- stocks[stocks[,9]<20,]
loss <- percent_50[percent_50[,10]<20,]
loss
final_percent <- (nrow(stocks)-nrow(loss))/nrow(stocks)
final_percent-(1-final_percent)
(1.2)^(nrow(stocks)*final_percent)*270
profit <- replicate(9,"20")
percent_50 <- stocks[stocks[,9]<20,]
loss <- percent_50[percent_50[,10]<20,]
loss
final_percent <- (nrow(stocks)-nrow(loss))/nrow(stocks)
final_percent-(1-final_percent)
(1.2)^(nrow(stocks)*final_percent)*270
profit <- replicate(9,"20")
profit
percent_50 <- stocks[stocks[,9]<20,]
loss <- percent_50[percent_50[,10]<20,]
loss
final_percent <- (nrow(stocks)-nrow(loss))/nrow(stocks)
final_percent-(1-final_percent)
(1.2)^(nrow(stocks)*final_percent)*270
profit <- replicate(9,"20")
profit[10] <- "-20"
profit <- replicate(9,"20")
profit[20] <- "-20"
profit <- replicate(9,"20")
profit[30] <- "-20"
profit <- replicate(9,"20")
profit[40] <- "-20"
percent_50 <- stocks[stocks[,9]<20,]
loss <- percent_50[percent_50[,10]<20,]
loss
final_percent <- (nrow(stocks)-nrow(loss))/nrow(stocks)
final_percent-(1-final_percent)
(1.2)^(nrow(stocks)*final_percent)*270
profit <- replicate(9,"20")
profit[10] <- "-20"
profit <- replicate(9,"20")
profit[20] <- "-20"
profit <- replicate(9,"20")
profit[30] <- "-20"
profit <- replicate(9,"20")
profit[40] <- "-20"
profit
profit <- replicate(9,"20")
profit <- append(profit,"-20")
profit
profit <- replicate(9,20)
profit <- append(profit,-20)
profit
percent_50 <- stocks[stocks[,9]<20,]
library(readxl)
stocks <- read_excel("stocks.xlsx")
stocks <- as.data.frame(stocks)
head(stocks)
stocks$`total %` <- ((stocks$`day high` - stocks$`prev close`)/stocks$`prev close`)*100
stocks$`open gap %` <- ((stocks$`open` - stocks$`prev close`)/stocks$`prev close`)*100
stocks$`5min - PM high%` <- ((stocks$`PM high` - stocks$`5 min high`)/stocks$`5 min high`)*100
stocks$`5min - day high%` <- ((stocks$`day high` - stocks$`5 min high`)/stocks$`5 min high`)*100
percent_50 <- stocks[stocks[,9]<20,]
loss <- percent_50[percent_50[,10]<20,]
loss
final_percent <- (nrow(stocks)-nrow(loss))/nrow(stocks)
final_percent-(1-final_percent)
(1.2)^(nrow(stocks)*final_percent)*270
profit <- replicate(9,20)
profit <- append(profit,-20)
profit <- replicate(9,20)
profit <- append(profit,-20)
profit <- replicate(9,20)
profit <- append(profit,-20)
profit <- replicate(9,20)
profit <- append(profit,-20)
profit
percent_50 <- stocks[stocks[,9]<20,]
loss <- percent_50[percent_50[,10]<20,]
loss
final_percent <- (nrow(stocks)-nrow(loss))/nrow(stocks)
final_percent-(1-final_percent)
(1.2)^(nrow(stocks)*final_percent)*270
profit <- c("20","20","20","20","20","20","20","20","20","-20","20","20","20","20","20","20","20","20","20","-20","20","20","20","20","20","20","20","20","20","-20","20","20","20","20","20","20","20","20","20","-20")
profit
percent_50 <- stocks[stocks[,9]<20,]
loss <- percent_50[percent_50[,10]<20,]
loss
final_percent <- (nrow(stocks)-nrow(loss))/nrow(stocks)
final_percent-(1-final_percent)
(1.2)^(nrow(stocks)*final_percent)*270
profit <- c("20","20","20","20","20","20","20","20","20","-20","20","20","20","20","20","20","20","20","20","-20","20","20","20","20","20","20","20","20","20","-20","20","20","20","20","20","20","20","20","20","-20")
profit <- as.numeric(profit)
profit
percent_50 <- stocks[stocks[,9]<20,]
loss <- percent_50[percent_50[,10]<20,]
loss
final_percent <- (nrow(stocks)-nrow(loss))/nrow(stocks)
final_percent-(1-final_percent)
(1.2)^(nrow(stocks)*final_percent)*270
percent_50 <- stocks[stocks[,9]<20,]
loss <- percent_50[percent_50[,10]<20,]
loss
final_percent <- (nrow(stocks)-nrow(loss))/nrow(stocks)
final_percent-(1-final_percent)
(1.2)^(nrow(stocks)*final_percent-(1-final_percent))*270
percent_50 <- stocks[stocks[,9]<50,]
loss <- percent_50[percent_50[,10]<50,]
loss
final_percent <- (nrow(stocks)-nrow(loss))/nrow(stocks)
final_percent
(1.2)^(nrow(stocks)*final_percent-(1-final_percent))*270
percent_50 <- stocks[stocks[,9]<50,]
loss <- percent_50[percent_50[,10]<50,]
loss
final_percent <- (nrow(stocks)-nrow(loss))/nrow(stocks)
final_percent
(1.5)^(nrow(stocks)*final_percent-(1-final_percent))*270
percent_50 <- stocks[stocks[,9]<50,]
percent_50 <- percent_50[percent_50[,10]<50,]
percent_50
final_percent <- (nrow(stocks)-nrow(loss))/nrow(stocks)
final_percent
(1.5)^(nrow(stocks)*final_percent-(1-final_percent))*270
percent_50 <- stocks[stocks[,9]<50,]
percent_50 <- percent_50[percent_50[,10]<50,]
percent_50 <- percent_50[percent_50[,9]<25,]
percent_50 <- percent_50[percent_50[,10]<25,]
percent_50
final_percent <- (nrow(stocks)-nrow(loss))/nrow(stocks)
final_percent
(1.5)^(nrow(stocks)*final_percent-(1-final_percent))*270
percent_50 <- stocks[stocks[,9]<50,]
percent_50 <- percent_50[percent_50[,10]<50,]
percent_50 <- percent_50[percent_50[,9]<25,]
percent_50 <- percent_50[percent_50[,10]<25,]
percent_50
final_percent <- (nrow(stocks)-nrow(percent_50))/nrow(stocks)
final_percent
(1.5)^(nrow(stocks)*final_percent-(1-final_percent))*270
percent_50 <- stocks[stocks[,9]<50,]
percent_50 <- percent_50[percent_50[,10]<50,]
percent_50 <- percent_50[percent_50[,9]<25,]
percent_50 <- percent_50[percent_50[,10]<25,]
percent_50
final_percent <- (nrow(stocks)-nrow(percent_50))/nrow(stocks)
final_percent
(1.5)^(nrow(stocks)*final_percent-(1-final_percent))*270
percent_50 <- stocks[stocks[,9]<50,]
percent_50 <- percent_50[percent_50[,10]<50,]
percent_50 <- percent_50[percent_50[,9]<25,]
percent_50 <- percent_50[percent_50[,10]<25,]
percent_50
final_percent <- (nrow(stocks)-nrow(percent_50))/nrow(stocks)
final_percent
(1.5)^(nrow(stocks)*final_percent-(1-final_percent))*20
percent_50 <- stocks[stocks[,9]<50,]
percent_50 <- percent_50[percent_50[,10]<50,]
percent_50 <- percent_50[percent_50[,9]<25,]
percent_50 <- percent_50[percent_50[,10]<25,]
percent_50
final_percent <- (nrow(stocks)-nrow(percent_50))/nrow(stocks)
final_percent
(1.25)^(nrow(stocks)*final_percent-(1-final_percent))*20
percent_50 <- stocks[stocks[,9]<50,]
percent_50 <- percent_50[percent_50[,10]<50,]
percent_50 <- percent_50[percent_50[,9]<25,]
percent_50 <- percent_50[percent_50[,10]<25,]
percent_50
final_percent <- (nrow(stocks)-nrow(percent_50))/nrow(stocks)
final_percent
(1.25)^(nrow(stocks)*final_percent-(1-final_percent))*200
percent_50 <- stocks[stocks[,9]<50,]
percent_50 <- percent_50[percent_50[,10]<50,]
percent_50 <- percent_50[percent_50[,9]<25,]
percent_50 <- percent_50[percent_50[,10]<25,]
percent_50
final_percent <- (nrow(stocks)-nrow(percent_50))/nrow(stocks)
final_percent
(1.25)^(nrow(stocks)*final_percent)*200
percent_50 <- stocks[stocks[,9]<50,]
percent_50 <- percent_50[percent_50[,10]<50,]
percent_50 <- percent_50[percent_50[,9]<25,]
percent_50 <- percent_50[percent_50[,10]<25,]
percent_50
final_percent <- (nrow(stocks)-nrow(percent_50))/nrow(stocks)
final_percent
(1.25)^(nrow(stocks)*final_percent)*20
percent_50 <- stocks[stocks[,9]<50,]
percent_50 <- percent_50[percent_50[,10]<50,]
percent_50 <- percent_50[percent_50[,9]<25,]
percent_50 <- percent_50[percent_50[,10]<25,]
percent_50
final_percent <- (nrow(stocks)-nrow(percent_50))/nrow(stocks)
final_percent
(1.25)^(nrow(stocks)*final_percent)*200
percent_50 <- stocks[stocks[,9]<25,]
#percent_50 <- percent_50[percent_50[,10]<50,]
#percent_50 <- percent_50[percent_50[,9]<25,]
percent_50 <- percent_50[percent_50[,10]<25,]
percent_50
final_percent <- (nrow(stocks)-nrow(percent_50))/nrow(stocks)
final_percent
(1.25)^(nrow(stocks)*final_percent)*200
percent_50 <- stocks[stocks[,9]<50,]
percent_50 <- percent_50[percent_50[,10]<50,]
#percent_50 <- percent_50[percent_50[,9]<25,]
#percent_50 <- percent_50[percent_50[,10]<25,]
percent_50
final_percent <- (nrow(stocks)-nrow(percent_50))/nrow(stocks)
final_percent
(1.25)^(nrow(stocks)*final_percent)*200
percent_50 <- stocks[stocks[,9]<50,]
percent_50 <- percent_50[percent_50[,10]<50,]
#percent_50 <- percent_50[percent_50[,9]<25,]
#percent_50 <- percent_50[percent_50[,10]<25,]
percent_50
final_percent <- (nrow(stocks)-nrow(percent_50))/nrow(stocks)
final_percent
(1.5)^(nrow(stocks)*final_percent)*200
percent_50 <- stocks[stocks[,9]<50,]
percent_50 <- percent_50[percent_50[,10]<50,]
#percent_50 <- percent_50[percent_50[,9]<25,]
#percent_50 <- percent_50[percent_50[,10]<25,]
percent_50
final_percent <- (nrow(stocks)-nrow(percent_50))/nrow(stocks)
final_percent
(1.5)^(nrow(stocks)*final_percent)*270
percent_50 <- stocks[stocks[,9]<50,]
percent_50
percent_50 <- stocks[stocks[,9]<50,]
percent_50 <- percent_50[percent_50[,10]<50,]
#percent_50 <- percent_50[percent_50[,9]<25,]
#percent_50 <- percent_50[percent_50[,10]<25,]
percent_50
final_percent <- (nrow(stocks)-nrow(percent_50))/nrow(stocks)
final_percent
(1.5)^(nrow(stocks)*final_percent)*270
percent_50 <- stocks[stocks[,9]<10,]
percent_50 <- percent_50[percent_50[,10]<10,]
#percent_50 <- percent_50[percent_50[,9]<25,]
#percent_50 <- percent_50[percent_50[,10]<25,]
percent_50
final_percent <- (nrow(stocks)-nrow(percent_50))/nrow(stocks)
final_percent
(1.5)^(nrow(stocks)*final_percent)*270
percent_50 <- stocks[stocks[,9]<10,]
percent_50 <- percent_50[percent_50[,10]<10,]
#percent_50 <- percent_50[percent_50[,9]<25,]
#percent_50 <- percent_50[percent_50[,10]<25,]
percent_50
final_percent <- (nrow(stocks)-nrow(percent_50))/nrow(stocks)
final_percent
(1.1)^(nrow(stocks)*final_percent)*270
percent_50 <- stocks[stocks[,9]<15,]
percent_50 <- percent_50[percent_50[,10]<15,]
#percent_50 <- percent_50[percent_50[,9]<25,]
#percent_50 <- percent_50[percent_50[,10]<25,]
percent_50
final_percent <- (nrow(stocks)-nrow(percent_50))/nrow(stocks)
final_percent
(1.1)^(nrow(stocks)*final_percent)*270
percent_50 <- stocks[stocks[,9]<15,]
percent_50 <- percent_50[percent_50[,10]<15,]
#percent_50 <- percent_50[percent_50[,9]<25,]
#percent_50 <- percent_50[percent_50[,10]<25,]
percent_50
final_percent <- (nrow(stocks)-nrow(percent_50))/nrow(stocks)
final_percent
(1.15)^(nrow(stocks)*final_percent)*270
percent_50 <- stocks[stocks[,9]<20,]
percent_50 <- percent_50[percent_50[,10]<20,]
#percent_50 <- percent_50[percent_50[,9]<25,]
#percent_50 <- percent_50[percent_50[,10]<25,]
percent_50
final_percent <- (nrow(stocks)-nrow(percent_50))/nrow(stocks)
final_percent
(1.15)^(nrow(stocks)*final_percent)*270
percent_50 <- stocks[stocks[,9]<20,]
percent_50 <- percent_50[percent_50[,10]<20,]
#percent_50 <- percent_50[percent_50[,9]<25,]
#percent_50 <- percent_50[percent_50[,10]<25,]
percent_50
final_percent <- (nrow(stocks)-nrow(percent_50))/nrow(stocks)
final_percent
(1.15)^(nrow(stocks)*final_percent)*2700
percent_50 <- stocks[stocks[,9]<20,]
percent_50 <- percent_50[percent_50[,10]<20,]
#percent_50 <- percent_50[percent_50[,9]<25,]
#percent_50 <- percent_50[percent_50[,10]<25,]
percent_50
final_percent <- (nrow(stocks)-nrow(percent_50))/nrow(stocks)
final_percent
(1.15)^(nrow(stocks)*final_percent)*270
percent_50 <- stocks[stocks[,9]<50,]
percent_50 <- percent_50[percent_50[,10]<50,]
#percent_50 <- percent_50[percent_50[,9]<25,]
#percent_50 <- percent_50[percent_50[,10]<25,]
percent_50
final_percent <- (nrow(stocks)-nrow(percent_50))/nrow(stocks)
final_percent
(1.15)^(nrow(stocks)*final_percent)*270
percent_50 <- stocks[stocks[,9]<25,]
percent_50 <- percent_50[percent_50[,10]<25,]
#percent_50 <- percent_50[percent_50[,9]<25,]
#percent_50 <- percent_50[percent_50[,10]<25,]
percent_50
final_percent <- (nrow(stocks)-nrow(percent_50))/nrow(stocks)
final_percent
(1.15)^(nrow(stocks)*final_percent)*270
?matplot
data4 <- read.table("CH11PR10.txt", sep = "" , header = F )
names(data4) <- c("y","x1","x2")
shipment <- data4
head(shipment)
data5 <- read.table("CH11PR10b.txt", sep = "" , header = F )
names(data5) <- c("c","b1","b2","vif","Rsq")
coeff <- data5
head(coeff)
plot(coeff$c,cbind(coeff$b1,coeff$b2),xlim = c(0,0.1), type = "l",ylab = "regression coefficients", xlab = "c")
matplot(coeff$c,cbind(coeff$b1,coeff$b2),xlim = c(0,0.1), type = "l",ylab = "regression coefficients", xlab = "c")
legend("topright",c("b1","b2"),col=c("black","red"),lwd=2)
library(MASS)
library(ElemStatLearn)
data(mcycle)
names(mcycle) <- c("x","y")
head(mcycle)
range(mcycle$x)
range(mcycle$y)
fit1 = smooth.spline(mcycle$x, mcycle$y,df = 12)
plot(fit1, , col="blue", type="l", xlab="x", ylab="y",xlim=c(0,60),ylim = c(-150,100),main = "Optimal smoothing spline fit",lwd=2)
points(mcycle, col="black", pch=20)
fit1
fit2 = smooth.spline(mcycle$x, mcycle$y, df = 5 )
fit3 = smooth.spline(mcycle$x, mcycle$y, df = 10  )
fit4 = smooth.spline(mcycle$x, mcycle$y, df = 15  )
plot(fit2, , col="blue", type="l", xlab="x", ylab="y",xlim=c(0,60),ylim = c(-150,100),main = "Smoothing spline fit for 5,10,15 df",lwd=2)
lines(fit3,xlim=c(0,60),ylim = c(-150,100), col="red",lwd=2)
lines(fit4,xlim=c(0,60),ylim = c(-150,100), col="dark green",lwd=2)
points(mcycle, col="black", pch=20)
legend("topright",c("5 df","10 df", "15 df"),col=c("blue","red","darkgreen"),lwd=2)
list <- lapply(seq(5,20,0.5), function(i) smooth.spline(mcycle$x,mcycle$y,df=i)$cv.crit)
cverr <- array(as.numeric(unlist(list)))
plot(seq(5,20,0.5),cverr,pch=19,col="blue",xlab="df(lambda)",ylim=c(min(cverr),max(cverr)),
ylab="CV error(lambda)")
lines(seq(5,20,0.5),cverr)
abline(v = 12,lty=2)
fit1 = smooth.spline(mcycle$x, mcycle$y,cv = TRUE)
plot(fit1, , col="blue", type="l", xlab="x", ylab="y",xlim=c(0,60),ylim = c(-150,100),main = "Optimal smoothing spline fit",lwd=2)
points(mcycle, col="black", pch=20)
fit1
setwd("C:/Users/arjun/OneDrive/math 564/Math-564-project")
setwd("C:/Users/arjun/OneDrive/math 564/Math-564-project/src")
df <- read.table("../data/raw/heart_failure_clinical_records_dataset.csv")
df <- read.table("../data/raw/heart_failure_clinical_records_dataset.csv")
head(df)
df <- read.table("../data/raw/heart_failure_clinical_records_dataset.csv")
head(df)
df <- read.table("../data/raw/heart_failure_clinical_records_dataset.csv")
head(df)
df <- read.table("../data/raw/heart_failure_clinical_records_dataset.csv")
head(df)
df <- read.table("../data/raw/heart_failure_clinical_records_dataset.csv")
head(df)
df <- read.table("../data/raw/heart_failure_clinical_records_dataset.csv", sep = ",",header = T)
head(df)
wd
getwd
getwd()
install.packages("Amelia")
df <- read.table("../data/raw/heart_failure_clinical_records_dataset.csv", sep = ",",header = T)
head(df)
library(Amelia)
df <- read.table("../data/raw/heart_failure_clinical_records_dataset.csv", sep = ",",header = T)
head(df)
library(Amelia)
misscounts <- sapply(df,function(x) sum(is.na(x)))
missmap(df, main = "Missing values")
sum(misscounts)
nrow(df)
summary(df)
df <- read.table("../data/raw/heart_failure_clinical_records_dataset.csv", sep = ",",header = T)
head(df)
primary <- df
library(Amelia)
misscounts <- sapply(primary,function(x) sum(is.na(x)))
missmap(primary, main = "Missing values")
sum(misscounts)
nrow(primary)
summary(primary)
primary$anaemia <- as.factor(primary$anaemia)
primary$diabetes <- as.factor(primary$diabetes)
primary$high_blood_pressure <- as.factor(primary$high_blood_pressure)
primary$sex <- as.factor(primary$sex)
primary$smoking <- as.factor(primary$smoking)
primary$DEATH_EVENT <- as.factor(primary$DEATH_EVENT)
summary(primary)
primary$anaemia <- as.factor(primary$anaemia)
primary$diabetes <- as.factor(primary$diabetes)
primary$high_blood_pressure <- as.factor(primary$high_blood_pressure)
primary$sex <- as.factor(primary$sex)
primary$smoking <- as.factor(primary$smoking)
primary$DEATH_EVENT <- as.factor(primary$DEATH_EVENT)
library(purrr)
library(tidyr)
library(ggplot2)
primary %>%
keep(is.numeric) %>%
gather() %>%
ggplot(aes(value)) +
facet_wrap(~ key, scales = "free") +
geom_histogram(aes(y=..density..), fill = "grey") +
geom_density()
primary$anaemia <- as.factor(primary$anaemia)
primary$diabetes <- as.factor(primary$diabetes)
primary$high_blood_pressure <- as.factor(primary$high_blood_pressure)
primary$sex <- as.factor(primary$sex)
primary$smoking <- as.factor(primary$smoking)
primary$DEATH_EVENT <- as.factor(primary$DEATH_EVENT)
summary(primary)
library(purrr)
library(tidyr)
library(ggplot2)
primary %>%
keep(is.numeric) %>%
gather() %>%
ggplot(aes(value)) +
facet_wrap(~ key, scales = "free") +
geom_histogram(aes(y=..density..), fill = "grey") +
geom_density()
df <- read.table("../data/raw/heart_failure_clinical_records_dataset.csv", sep = ",",header = T)
head(df)
primary <- df
library(Amelia)
misscounts <- sapply(primary,function(x) sum(is.na(x)))
missmap(primary, main = "Missing values")
sum(misscounts)
nrow(primary)
primary$anaemia <- as.factor(primary$anaemia)
primary$diabetes <- as.factor(primary$diabetes)
primary$high_blood_pressure <- as.factor(primary$high_blood_pressure)
primary$sex <- as.factor(primary$sex)
primary$smoking <- as.factor(primary$smoking)
primary$DEATH_EVENT <- as.factor(primary$DEATH_EVENT)
summary(primary)
library(purrr)
library(tidyr)
library(ggplot2)
primary %>%
keep(is.numeric) %>%
gather() %>%
ggplot(aes(value)) +
facet_wrap(~ key, scales = "free") +
geom_histogram(aes(y=..density..), fill = "grey") +
geom_density()
