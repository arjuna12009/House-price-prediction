table(combined$FireplaceQu, useNA = "ifany")
str(combined$FireplaceQu)
anyNA(combined$FireplaceQu)
table(is.na(combined$LotFrontage))
# predictors that lotfrontage variable might depend on.
predictors <- c("MSSubClass", "MSZoning", "LotFrontage", "LotArea", "Street", "Alley", "LotShape", "LandContour", "LotConfig", "LandSlope", "BldgType", "HouseStyle", "YrSold", "SaleType", "SaleCondition")
library(rpart)
mod <- rpart(LotFrontage~., data = combined[!is.na(combined$LotFrontage),predictors], method = "anova", na.action = na.omit)
pred <- predict(mod, combined[is.na(combined$LotFrontage),predictors])
pred <- round(pred)
combined$LotFrontage[is.na(combined$LotFrontage)] <- pred
anyNA(combined$LotFrontage)
table(combined$LotShape, useNA = "ifany")
combined$LotShape <- factor(combined$LotShape, order = TRUE, levels = c("IR3" , "IR2" , "IR1" , "Reg" ))
table(combined$LotConfig, useNA = "ifany")
combined$LotConfig <- as.factor(combined$LotConfig)
sort(colSums(sapply(combined, is.na)), decreasing = T)
garage <- c("GarageYrBlt","GarageType","GarageFinish","GarageQual","GarageCond","GarageCars","GarageArea")
sort(colSums(sapply(combined[,garage], is.na)), decreasing = T)
combined$GarageYrBlt[is.na(combined$GarageYrBlt)] <- combined$YearBuilt[is.na(combined$GarageYrBlt)]
combined$GarageType[is.na(combined$GarageType)] <- "None"
combined$GarageFinish[is.na(combined$GarageFinish)] <- "None"
combined$GarageCond[is.na(combined$GarageCond)] <- "None"
combined$GarageQual[is.na(combined$GarageQual)] <- "None"
sort(colSums(sapply(combined[,garage], is.na)), decreasing = T)
# convert into factor
combined$GarageType <- as.factor(combined$GarageType)
table(combined$GarageType)
# convert into ordinal
Finish <- c('None', 'Unf', 'RFn', 'Fin')
combined$GarageFinish<-factor(combined$GarageFinish, order = TRUE, levels = Finish)
table(combined$GarageFinish, useNA = 'ifany')
combined$GarageCond<-factor(combined$GarageCond, order = TRUE, levels = encoding_levels)
table(combined$GarageCond, useNA = "ifany")
combined$GarageQual<-factor(combined$GarageQual, order = TRUE, levels = encoding_levels)
table(combined$GarageQual, useNA = "ifany")
basement <- c("BsmtQual","BsmtCond","BsmtExposure","BsmtFinType1","BsmtFinType2","BsmtFullBath","BsmtHalfBath","BsmtFinSF1","BsmtFinSF2","BsmtUnfSF","TotalBsmtSF")
sort(colSums(sapply(combined[,basement], is.na)), decreasing = T)
x <- which(!is.na(combined$BsmtFinType1) & (is.na(combined$BsmtCond)|is.na(combined$BsmtExposure)|is.na(combined$BsmtQual)|is.na(combined$BsmtFinType2)))
combined[x,basement]
# impute mode
combined[c(949),"BsmtExposure"] <- names(sort(-table(combined$BsmtExposure)))[1]
combined[c(333),"BsmtFinType2"] <- names(sort(-table(combined$BsmtFinType2)))[1]
combined[x,basement]
anyNA(combined[x,basement])
sort(colSums(sapply(combined[,basement], is.na)), decreasing = T)
combined[is.na(combined[,"TotalBsmtSF"]),basement]
combined[is.na(combined[,"BsmtHalfBath"]),basement]
combined$BsmtQual[is.na(combined$BsmtQual)] <- "None"
combined$BsmtCond[is.na(combined$BsmtCond)] <- "None"
combined$BsmtExposure[is.na(combined$BsmtExposure)] <- "None"
combined$BsmtFinType1[is.na(combined$BsmtFinType1)] <- "None"
combined$BsmtFinType2[is.na(combined$BsmtFinType2)] <- "None"
combined$BsmtFullBath[is.na(combined$BsmtFullBath)] <- 0
combined$BsmtHalfBath[is.na(combined$BsmtHalfBath)] <- 0
sort(colSums(sapply(combined[,basement], is.na)), decreasing = T)
#install.packages(c("Amelia","purrr","tidyr","ggplot2","rpart","plyr"))
df <- read.table("../data/raw/train.csv", sep = ",",header = T)
head(df)
combined <- df
str(combined)
library(Amelia)
misscounts <- sapply(combined,function(x) sum(is.na(x)))
missmap(combined, main = "Missing values")
sort(colSums(sapply(combined, is.na)), decreasing = T)
table(is.na(combined$PoolQC))
table(combined$PoolArea, combined$PoolQC, useNA = 'ifany')
library(plyr)
combined[combined$PoolArea==0,]$PoolQC <- "None"
# convert all NA's in PoolQC to none except for the 3 actual missing values.
combined[is.na(combined$PoolQC),c("OverallQual","PoolArea")]
# imputing the values of poolQC according to overall quality and pool area.
combined[is.na(combined$PoolQC),"PoolQC"] <- c("TA","Gd","TA")
# label encoding as the values are ordinal.
encoding_levels <- c('None', 'Po' , 'Fa', 'TA' , 'Gd', 'Ex' )
combined$PoolQC <- factor(combined$PoolQC, order = TRUE, levels = encoding_levels)
table(combined$PoolQC)
str(combined$PoolQC)
table(combined$MiscFeature, useNA = "ifany")
library(ggplot2)
# convert all NA's in MiscFeature to none.
combined[is.na(combined$MiscFeature),"MiscFeature"] <- "None"
# convert to factor
combined$MiscFeature <- as.factor(combined$MiscFeature)
ggplot(combined, aes(x=MiscFeature, y = SalePrice)) + geom_bar(stat = 'summary')
table(combined$Alley, useNA = "ifany")
# convert all NA's in Alley to none.
combined[is.na(combined$Alley),"Alley"] <- "None"
# convert to factor
combined$Alley <- as.factor(combined$Alley)
ggplot(combined, aes(x=Alley, y = SalePrice)) + geom_bar(stat = 'summary')
table(combined$Fence, useNA = "ifany")
# convert all NA's in Fence to none.
combined[is.na(combined$Fence),"Fence"] <- "None"
# convert to factor
combined$Fence <- as.factor(combined$Fence)
ggplot(combined, aes(x=Fence, y = SalePrice)) + geom_bar(stat = 'summary')
table(combined$FireplaceQu, useNA = "ifany")
# convert all NA's in FireplaceQu to none.
combined[is.na(combined$FireplaceQu),"FireplaceQu"] <- "None"
# Changing and converting to factor levels from character.
combined$FireplaceQu <- factor(combined$FireplaceQu, order = TRUE, levels = encoding_levels)
table(combined$FireplaceQu, useNA = "ifany")
str(combined$FireplaceQu)
anyNA(combined$FireplaceQu)
table(is.na(combined$LotFrontage))
# predictors that lotfrontage variable might depend on.
predictors <- c("MSSubClass", "MSZoning", "LotFrontage", "LotArea", "Street", "Alley", "LotShape", "LandContour", "LotConfig", "LandSlope", "BldgType", "HouseStyle", "YrSold", "SaleType", "SaleCondition")
library(rpart)
mod <- rpart(LotFrontage~., data = combined[!is.na(combined$LotFrontage),predictors], method = "anova", na.action = na.omit)
pred <- predict(mod, combined[is.na(combined$LotFrontage),predictors])
pred <- round(pred)
combined$LotFrontage[is.na(combined$LotFrontage)] <- pred
anyNA(combined$LotFrontage)
table(combined$LotShape, useNA = "ifany")
combined$LotShape <- factor(combined$LotShape, order = TRUE, levels = c("IR3" , "IR2" , "IR1" , "Reg" ))
table(combined$LotConfig, useNA = "ifany")
combined$LotConfig <- as.factor(combined$LotConfig)
sort(colSums(sapply(combined, is.na)), decreasing = T)
garage <- c("GarageYrBlt","GarageType","GarageFinish","GarageQual","GarageCond","GarageCars","GarageArea")
sort(colSums(sapply(combined[,garage], is.na)), decreasing = T)
combined$GarageYrBlt[is.na(combined$GarageYrBlt)] <- combined$YearBuilt[is.na(combined$GarageYrBlt)]
combined$GarageType[is.na(combined$GarageType)] <- "None"
combined$GarageFinish[is.na(combined$GarageFinish)] <- "None"
combined$GarageCond[is.na(combined$GarageCond)] <- "None"
combined$GarageQual[is.na(combined$GarageQual)] <- "None"
sort(colSums(sapply(combined[,garage], is.na)), decreasing = T)
# convert into factor
combined$GarageType <- as.factor(combined$GarageType)
table(combined$GarageType)
# convert into ordinal
Finish <- c('None', 'Unf', 'RFn', 'Fin')
combined$GarageFinish<-factor(combined$GarageFinish, order = TRUE, levels = Finish)
table(combined$GarageFinish, useNA = 'ifany')
combined$GarageCond<-factor(combined$GarageCond, order = TRUE, levels = encoding_levels)
table(combined$GarageCond, useNA = "ifany")
combined$GarageQual<-factor(combined$GarageQual, order = TRUE, levels = encoding_levels)
table(combined$GarageQual, useNA = "ifany")
basement <- c("BsmtQual","BsmtCond","BsmtExposure","BsmtFinType1","BsmtFinType2","BsmtFullBath","BsmtHalfBath","BsmtFinSF1","BsmtFinSF2","BsmtUnfSF","TotalBsmtSF")
sort(colSums(sapply(combined[,basement], is.na)), decreasing = T)
x <- which(!is.na(combined$BsmtFinType1) & (is.na(combined$BsmtCond)|is.na(combined$BsmtExposure)|is.na(combined$BsmtQual)|is.na(combined$BsmtFinType2)))
combined[x,basement]
# impute mode
combined[c(949),"BsmtExposure"] <- names(sort(-table(combined$BsmtExposure)))[1]
combined[c(333),"BsmtFinType2"] <- names(sort(-table(combined$BsmtFinType2)))[1]
combined[x,basement]
anyNA(combined[x,basement])
sort(colSums(sapply(combined[,basement], is.na)), decreasing = T)
combined$BsmtQual[is.na(combined$BsmtQual)] <- "None"
combined$BsmtCond[is.na(combined$BsmtCond)] <- "None"
combined$BsmtExposure[is.na(combined$BsmtExposure)] <- "None"
combined$BsmtFinType1[is.na(combined$BsmtFinType1)] <- "None"
combined$BsmtFinType2[is.na(combined$BsmtFinType2)] <- "None"
combined$BsmtFullBath[is.na(combined$BsmtFullBath)] <- 0
combined$BsmtHalfBath[is.na(combined$BsmtHalfBath)] <- 0
sort(colSums(sapply(combined[,basement], is.na)), decreasing = T)
# convert to ordinal
combined$BsmtQual<-factor(combined$BsmtQual, order = TRUE, levels = encoding_levels)
table(combined$BsmtQual, useNA = "ifany")
combined$BsmtCond<-factor(combined$BsmtCond, order = TRUE, levels = encoding_levels)
table(combined$BsmtCond, useNA = "ifany")
exposure <- c('None','No','Mn','Av','Gd')
combined$BsmtExposure<-factor(combined$BsmtExposure, order = TRUE, levels = exposure)
table(combined$BsmtExposure, useNA = "ifany")
rating <- c('None','Unf','LwQ','Rec','BLQ','ALQ','GLQ')
combined$BsmtFinType1<-factor(combined$BsmtFinType1, order = TRUE, levels = rating)
table(combined$BsmtFinType1, useNA = "ifany")
combined$BsmtFinType2<-factor(combined$BsmtFinType2, order = TRUE, levels = rating)
table(combined$BsmtFinType2, useNA = "ifany")
combined$BsmtFullBath
#install.packages(c("Amelia","purrr","tidyr","ggplot2","rpart","plyr"))
df <- read.table("../data/raw/train.csv", sep = ",",header = T)
head(df)
combined <- df
str(combined)
library(Amelia)
misscounts <- sapply(combined,function(x) sum(is.na(x)))
missmap(combined, main = "Missing values")
sort(colSums(sapply(combined, is.na)), decreasing = T)
table(is.na(combined$PoolQC))
table(combined$PoolArea, combined$PoolQC, useNA = 'ifany')
library(plyr)
combined[combined$PoolArea==0,]$PoolQC <- "None"
# convert all NA's in PoolQC to none except for the 3 actual missing values.
combined[is.na(combined$PoolQC),c("OverallQual","PoolArea")]
# imputing the values of poolQC according to overall quality and pool area.
combined[is.na(combined$PoolQC),"PoolQC"] <- c("TA","Gd","TA")
# label encoding as the values are ordinal.
encoding_levels <- c('None', 'Po' , 'Fa', 'TA' , 'Gd', 'Ex' )
combined$PoolQC <- factor(combined$PoolQC, order = TRUE, levels = encoding_levels)
table(combined$PoolQC)
str(combined$PoolQC)
table(combined$MiscFeature, useNA = "ifany")
library(ggplot2)
# convert all NA's in MiscFeature to none.
combined[is.na(combined$MiscFeature),"MiscFeature"] <- "None"
# convert to factor
combined$MiscFeature <- as.factor(combined$MiscFeature)
ggplot(combined, aes(x=MiscFeature, y = SalePrice)) + geom_bar(stat = 'summary')
table(combined$Alley, useNA = "ifany")
# convert all NA's in Alley to none.
combined[is.na(combined$Alley),"Alley"] <- "None"
# convert to factor
combined$Alley <- as.factor(combined$Alley)
ggplot(combined, aes(x=Alley, y = SalePrice)) + geom_bar(stat = 'summary')
table(combined$Fence, useNA = "ifany")
# convert all NA's in Fence to none.
combined[is.na(combined$Fence),"Fence"] <- "None"
# convert to factor
combined$Fence <- as.factor(combined$Fence)
ggplot(combined, aes(x=Fence, y = SalePrice)) + geom_bar(stat = 'summary')
table(combined$FireplaceQu, useNA = "ifany")
# convert all NA's in FireplaceQu to none.
combined[is.na(combined$FireplaceQu),"FireplaceQu"] <- "None"
# Changing and converting to factor levels from character.
combined$FireplaceQu <- factor(combined$FireplaceQu, order = TRUE, levels = encoding_levels)
table(combined$FireplaceQu, useNA = "ifany")
str(combined$FireplaceQu)
anyNA(combined$FireplaceQu)
table(is.na(combined$LotFrontage))
# predictors that lotfrontage variable might depend on.
predictors <- c("MSSubClass", "MSZoning", "LotFrontage", "LotArea", "Street", "Alley", "LotShape", "LandContour", "LotConfig", "LandSlope", "BldgType", "HouseStyle", "YrSold", "SaleType", "SaleCondition")
library(rpart)
mod <- rpart(LotFrontage~., data = combined[!is.na(combined$LotFrontage),predictors], method = "anova", na.action = na.omit)
pred <- predict(mod, combined[is.na(combined$LotFrontage),predictors])
pred <- round(pred)
combined$LotFrontage[is.na(combined$LotFrontage)] <- pred
anyNA(combined$LotFrontage)
table(combined$LotShape, useNA = "ifany")
combined$LotShape <- factor(combined$LotShape, order = TRUE, levels = c("IR3" , "IR2" , "IR1" , "Reg" ))
table(combined$LotConfig, useNA = "ifany")
combined$LotConfig <- as.factor(combined$LotConfig)
sort(colSums(sapply(combined, is.na)), decreasing = T)
garage <- c("GarageYrBlt","GarageType","GarageFinish","GarageQual","GarageCond","GarageCars","GarageArea")
sort(colSums(sapply(combined[,garage], is.na)), decreasing = T)
combined$GarageYrBlt[is.na(combined$GarageYrBlt)] <- combined$YearBuilt[is.na(combined$GarageYrBlt)]
combined$GarageType[is.na(combined$GarageType)] <- "None"
combined$GarageFinish[is.na(combined$GarageFinish)] <- "None"
combined$GarageCond[is.na(combined$GarageCond)] <- "None"
combined$GarageQual[is.na(combined$GarageQual)] <- "None"
sort(colSums(sapply(combined[,garage], is.na)), decreasing = T)
# convert into factor
combined$GarageType <- as.factor(combined$GarageType)
table(combined$GarageType)
# convert into ordinal
Finish <- c('None', 'Unf', 'RFn', 'Fin')
combined$GarageFinish<-factor(combined$GarageFinish, order = TRUE, levels = Finish)
table(combined$GarageFinish, useNA = 'ifany')
combined$GarageCond<-factor(combined$GarageCond, order = TRUE, levels = encoding_levels)
table(combined$GarageCond, useNA = "ifany")
combined$GarageQual<-factor(combined$GarageQual, order = TRUE, levels = encoding_levels)
table(combined$GarageQual, useNA = "ifany")
basement <- c("BsmtQual","BsmtCond","BsmtExposure","BsmtFinType1","BsmtFinType2","BsmtFullBath","BsmtHalfBath","BsmtFinSF1","BsmtFinSF2","BsmtUnfSF","TotalBsmtSF")
sort(colSums(sapply(combined[,basement], is.na)), decreasing = T)
x <- which(!is.na(combined$BsmtFinType1) & (is.na(combined$BsmtCond)|is.na(combined$BsmtExposure)|is.na(combined$BsmtQual)|is.na(combined$BsmtFinType2)))
combined[x,basement]
# impute mode
combined[c(949),"BsmtExposure"] <- names(sort(-table(combined$BsmtExposure)))[1]
combined[c(333),"BsmtFinType2"] <- names(sort(-table(combined$BsmtFinType2)))[1]
combined[x,basement]
anyNA(combined[x,basement])
sort(colSums(sapply(combined[,basement], is.na)), decreasing = T)
combined$BsmtQual[is.na(combined$BsmtQual)] <- "None"
combined$BsmtCond[is.na(combined$BsmtCond)] <- "None"
combined$BsmtExposure[is.na(combined$BsmtExposure)] <- "None"
combined$BsmtFinType1[is.na(combined$BsmtFinType1)] <- "None"
combined$BsmtFinType2[is.na(combined$BsmtFinType2)] <- "None"
combined$BsmtFullBath[is.na(combined$BsmtFullBath)] <- 0
combined$BsmtHalfBath[is.na(combined$BsmtHalfBath)] <- 0
sort(colSums(sapply(combined[,basement], is.na)), decreasing = T)
# convert to ordinal
combined$BsmtQual<-factor(combined$BsmtQual, order = TRUE, levels = encoding_levels)
table(combined$BsmtQual, useNA = "ifany")
combined$BsmtCond<-factor(combined$BsmtCond, order = TRUE, levels = encoding_levels)
table(combined$BsmtCond, useNA = "ifany")
exposure <- c('None','No','Mn','Av','Gd')
combined$BsmtExposure<-factor(combined$BsmtExposure, order = TRUE, levels = exposure)
table(combined$BsmtExposure, useNA = "ifany")
rating <- c('None','Unf','LwQ','Rec','BLQ','ALQ','GLQ')
combined$BsmtFinType1<-factor(combined$BsmtFinType1, order = TRUE, levels = rating)
table(combined$BsmtFinType1, useNA = "ifany")
combined$BsmtFinType2<-factor(combined$BsmtFinType2, order = TRUE, levels = rating)
table(combined$BsmtFinType2, useNA = "ifany")
sort(colSums(sapply(combined, is.na)), decreasing = T)
x <- which(!is.na(combined$MasVnrArea) & is.na(combined$MasVnrType) )
combined[x,c("MasVnrArea","MasVnrType")]
combined[x,c("MasVnrArea","MasVnrType")]
sort(colSums(sapply(combined, is.na)), decreasing = T)
sort(colSums(sapply(combined, is.na)), decreasing = T)
combined$MasVnrType[is.na(combined$MasVnrType)] <- "None"
combined$MasVnrArea[is.na(combined$MasVnrArea)] <- 0
combined$MasVnrType <- as.factor(combined$MasVnrType)
table(combined$MasVnrType)
sort(colSums(sapply(combined, is.na)), decreasing = T)
categorical_variables <- c('GarageType',"MSZoning","Utilities","Exterior1st","Exterior2nd","Electrical","SaleType","SaleCondition","Foundation","Heating","CentralAir","RoofStyle","RoofMatl","LandContour","BldgType","HouseStyle","Neighborhood","Condition1","Condition2","Street","MSSubClass","MoSold","YrSold")
table(combined$Electrical, useNA = "ifany")
combined$Electrical[is.na(combined$Electrical)] <-
names(sort(-table(combined$Electrical)))[1]
combined$Electrical <- as.factor(combined$Electrical)
x <- sort(colSums(sapply(combined[,categorical_variables], is.na)), decreasing = T)
x
for(i in 1:length(names(x)))
{
combined[,names(x)[i]] <- as.factor(combined[,names(x)[i]])
}
str(combined[,categorical_variables])
sort(colSums(sapply(combined, is.na)), decreasing = T)
combined[is.na(combined$Functional),"Functional"] <- names(sort(-table(combined$Functional)))[1]
functionality <- c('Sal', 'Sev', 'Maj2', 'Maj1', 'Mod', 'Min2', 'Min1', 'Typ')
combined$Functional <- factor(combined$Functional, order = TRUE, levels = functionality)
combined[is.na(combined$KitchenQual),"KitchenQual"] <- names(sort(-table(combined$KitchenQual)))[1]
combined$KitchenQual <- factor(combined$KitchenQual, order = TRUE, levels = encoding_levels)
sort(colSums(sapply(combined, is.na)), decreasing = T)
char_columns <- names(combined[,sapply(combined, is.character)])
char_columns
# convert remaining character variables into categorical
combined$LandSlope <- factor(combined$LandSlope, order = TRUE, levels = c('Sev','Mod','Gtl'))
combined$ExterQual <- factor(combined$ExterQual, order = TRUE, levels = encoding_levels)
combined$ExterCond <- factor(combined$ExterCond, order = TRUE, levels = encoding_levels)
combined$HeatingQC <- factor(combined$HeatingQC, order = TRUE, levels = encoding_levels)
combined$PavedDrive <- factor(combined$PavedDrive, order = TRUE, levels = c('N','P','Y'))
misscounts <- sapply(combined,function(x) sum(is.na(x)))
missmap(combined, main = "Missing values")
anyNA(combined[,!names(combined) %in% c("SalePrice")])
misscounts <- sapply(combined,function(x) sum(is.na(x)))
missmap(combined, main = "Missing values")
anyNA(combined)
num_vars <- which(sapply(combined,is.numeric))
factor_vars <- which(sapply(combined,is.factor))
cat('numeric variables: ', length(num_vars),' and categorical variables: ',length(factor_vars),'\n')
str(combined)
library(readxl)
data <- read_excel("stocks.xlsx")
data <- as.data.frame(data)
head(data)
stocks <- data[,c(1,2,3,4)]
stocks$float_rotation <- stocks$`PM vol`/stocks$float
plot(stocks$float_rotation,stocks$`%chg`)
abline(v = 0.5)
stocks1 <- stocks[which(stocks$`float_rotation`>0.5),]
stocks2 <- stocks1[stocks1[,2]>50,]
stocks3 <- stocks1[stocks1[,2]<50,]
percent <- nrow(stocks2)/nrow(stocks1)
profit <- (1.5^round(percent * nrow(stocks1),1))*200
loss <- (1.25^round((1-percent) * nrow(stocks1),1))*200
profit
loss
profit - loss
min(stocks2[-18,"float_rotation"])
stocks2
stocks3
stocks[which(stocks$`float_rotation`<0.5),]
setwd("C:/Users/arjun/OneDrive/math 564/Math-564-project/src")
#install.packages(c("Amelia","purrr","tidyr","ggplot2","rpart","plyr"))
df <- read.table("../data/raw/train.csv", sep = ",",header = T)
head(df)
combined <- df
str(combined)
library(Amelia)
misscounts <- sapply(combined,function(x) sum(is.na(x)))
missmap(combined, main = "Missing values")
sort(colSums(sapply(combined, is.na)), decreasing = T)
table(is.na(combined$PoolQC))
table(combined$PoolArea, combined$PoolQC, useNA = 'ifany')
library(plyr)
combined[combined$PoolArea==0,]$PoolQC <- "None"
# convert all NA's in PoolQC to none except for the 3 actual missing values.
combined[is.na(combined$PoolQC),c("OverallQual","PoolArea")]
# imputing the values of poolQC according to overall quality and pool area.
combined[is.na(combined$PoolQC),"PoolQC"] <- c("TA","Gd","TA")
# label encoding as the values are ordinal.
encoding_levels <- c('None', 'Po' , 'Fa', 'TA' , 'Gd', 'Ex' )
combined$PoolQC <- factor(combined$PoolQC, order = TRUE, levels = encoding_levels)
table(combined$PoolQC)
str(combined$PoolQC)
table(combined$MiscFeature, useNA = "ifany")
library(ggplot2)
# convert all NA's in MiscFeature to none.
combined[is.na(combined$MiscFeature),"MiscFeature"] <- "None"
# convert to factor
combined$MiscFeature <- as.factor(combined$MiscFeature)
ggplot(combined, aes(x=MiscFeature, y = SalePrice)) + geom_bar(stat = 'summary')
table(combined$Alley, useNA = "ifany")
# convert all NA's in Alley to none.
combined[is.na(combined$Alley),"Alley"] <- "None"
# convert to factor
combined$Alley <- as.factor(combined$Alley)
ggplot(combined, aes(x=Alley, y = SalePrice)) + geom_bar(stat = 'summary')
table(combined$Fence, useNA = "ifany")
# convert all NA's in Fence to none.
combined[is.na(combined$Fence),"Fence"] <- "None"
# convert to factor
combined$Fence <- as.factor(combined$Fence)
ggplot(combined, aes(x=Fence, y = SalePrice)) + geom_bar(stat = 'summary')
table(combined$FireplaceQu, useNA = "ifany")
# convert all NA's in FireplaceQu to none.
combined[is.na(combined$FireplaceQu),"FireplaceQu"] <- "None"
# Changing and converting to factor levels from character.
combined$FireplaceQu <- factor(combined$FireplaceQu, order = TRUE, levels = encoding_levels)
table(combined$FireplaceQu, useNA = "ifany")
str(combined$FireplaceQu)
anyNA(combined$FireplaceQu)
table(is.na(combined$LotFrontage))
# predictors that lotfrontage variable might depend on.
predictors <- c("MSSubClass", "MSZoning", "LotFrontage", "LotArea", "Street", "Alley", "LotShape", "LandContour", "LotConfig", "LandSlope", "BldgType", "HouseStyle", "YrSold", "SaleType", "SaleCondition")
library(rpart)
mod <- rpart(LotFrontage~., data = combined[!is.na(combined$LotFrontage),predictors], method = "anova", na.action = na.omit)
pred <- predict(mod, combined[is.na(combined$LotFrontage),predictors])
pred <- round(pred)
combined$LotFrontage[is.na(combined$LotFrontage)] <- pred
anyNA(combined$LotFrontage)
table(combined$LotShape, useNA = "ifany")
combined$LotShape <- factor(combined$LotShape, order = TRUE, levels = c("IR3" , "IR2" , "IR1" , "Reg" ))
table(combined$LotConfig, useNA = "ifany")
combined$LotConfig <- as.factor(combined$LotConfig)
sort(colSums(sapply(combined, is.na)), decreasing = T)
garage <- c("GarageYrBlt","GarageType","GarageFinish","GarageQual","GarageCond","GarageCars","GarageArea")
sort(colSums(sapply(combined[,garage], is.na)), decreasing = T)
combined$GarageYrBlt[is.na(combined$GarageYrBlt)] <- combined$YearBuilt[is.na(combined$GarageYrBlt)]
combined$GarageType[is.na(combined$GarageType)] <- "None"
combined$GarageFinish[is.na(combined$GarageFinish)] <- "None"
combined$GarageCond[is.na(combined$GarageCond)] <- "None"
combined$GarageQual[is.na(combined$GarageQual)] <- "None"
sort(colSums(sapply(combined[,garage], is.na)), decreasing = T)
# convert into factor
combined$GarageType <- as.factor(combined$GarageType)
table(combined$GarageType)
# convert into ordinal
Finish <- c('None', 'Unf', 'RFn', 'Fin')
combined$GarageFinish<-factor(combined$GarageFinish, order = TRUE, levels = Finish)
table(combined$GarageFinish, useNA = 'ifany')
combined$GarageCond<-factor(combined$GarageCond, order = TRUE, levels = encoding_levels)
table(combined$GarageCond, useNA = "ifany")
combined$GarageQual<-factor(combined$GarageQual, order = TRUE, levels = encoding_levels)
table(combined$GarageQual, useNA = "ifany")
basement <- c("BsmtQual","BsmtCond","BsmtExposure","BsmtFinType1","BsmtFinType2","BsmtFullBath","BsmtHalfBath","BsmtFinSF1","BsmtFinSF2","BsmtUnfSF","TotalBsmtSF")
sort(colSums(sapply(combined[,basement], is.na)), decreasing = T)
x <- which(!is.na(combined$BsmtFinType1) & (is.na(combined$BsmtCond)|is.na(combined$BsmtExposure)|is.na(combined$BsmtQual)|is.na(combined$BsmtFinType2)))
combined[x,basement]
# impute mode
combined[c(949),"BsmtExposure"] <- names(sort(-table(combined$BsmtExposure)))[1]
combined[c(333),"BsmtFinType2"] <- names(sort(-table(combined$BsmtFinType2)))[1]
combined[x,basement]
anyNA(combined[x,basement])
sort(colSums(sapply(combined[,basement], is.na)), decreasing = T)
combined$BsmtQual[is.na(combined$BsmtQual)] <- "None"
combined$BsmtCond[is.na(combined$BsmtCond)] <- "None"
combined$BsmtExposure[is.na(combined$BsmtExposure)] <- "None"
combined$BsmtFinType1[is.na(combined$BsmtFinType1)] <- "None"
combined$BsmtFinType2[is.na(combined$BsmtFinType2)] <- "None"
combined$BsmtFullBath[is.na(combined$BsmtFullBath)] <- 0
combined$BsmtHalfBath[is.na(combined$BsmtHalfBath)] <- 0
sort(colSums(sapply(combined[,basement], is.na)), decreasing = T)
# convert to ordinal
combined$BsmtQual<-factor(combined$BsmtQual, order = TRUE, levels = encoding_levels)
table(combined$BsmtQual, useNA = "ifany")
combined$BsmtCond<-factor(combined$BsmtCond, order = TRUE, levels = encoding_levels)
table(combined$BsmtCond, useNA = "ifany")
exposure <- c('None','No','Mn','Av','Gd')
combined$BsmtExposure<-factor(combined$BsmtExposure, order = TRUE, levels = exposure)
table(combined$BsmtExposure, useNA = "ifany")
rating <- c('None','Unf','LwQ','Rec','BLQ','ALQ','GLQ')
combined$BsmtFinType1<-factor(combined$BsmtFinType1, order = TRUE, levels = rating)
table(combined$BsmtFinType1, useNA = "ifany")
combined$BsmtFinType2<-factor(combined$BsmtFinType2, order = TRUE, levels = rating)
table(combined$BsmtFinType2, useNA = "ifany")
sort(colSums(sapply(combined, is.na)), decreasing = T)
combined$MasVnrType[is.na(combined$MasVnrType)] <- "None"
combined$MasVnrArea[is.na(combined$MasVnrArea)] <- 0
combined$MasVnrType <- as.factor(combined$MasVnrType)
table(combined$MasVnrType)
sort(colSums(sapply(combined, is.na)), decreasing = T)
categorical_variables <- c('GarageType',"MSZoning","Utilities","Exterior1st","Exterior2nd","Electrical","SaleType","SaleCondition","Foundation","Heating","CentralAir","RoofStyle","RoofMatl","LandContour","BldgType","HouseStyle","Neighborhood","Condition1","Condition2","Street","MSSubClass","MoSold","YrSold")
table(combined$Electrical, useNA = "ifany")
combined$Electrical[is.na(combined$Electrical)] <-
names(sort(-table(combined$Electrical)))[1]
combined$Electrical <- as.factor(combined$Electrical)
x <- sort(colSums(sapply(combined[,categorical_variables], is.na)), decreasing = T)
x
for(i in 1:length(names(x)))
{
combined[,names(x)[i]] <- as.factor(combined[,names(x)[i]])
}
str(combined[,categorical_variables])
sort(colSums(sapply(combined, is.na)), decreasing = T)
combined[is.na(combined$Functional),"Functional"] <- names(sort(-table(combined$Functional)))[1]
functionality <- c('Sal', 'Sev', 'Maj2', 'Maj1', 'Mod', 'Min2', 'Min1', 'Typ')
combined$Functional <- factor(combined$Functional, order = TRUE, levels = functionality)
combined[is.na(combined$KitchenQual),"KitchenQual"] <- names(sort(-table(combined$KitchenQual)))[1]
combined$KitchenQual <- factor(combined$KitchenQual, order = TRUE, levels = encoding_levels)
sort(colSums(sapply(combined, is.na)), decreasing = T)
char_columns <- names(combined[,sapply(combined, is.character)])
char_columns
# convert remaining character variables into categorical
combined$LandSlope <- factor(combined$LandSlope, order = TRUE, levels = c('Sev','Mod','Gtl'))
combined$ExterQual <- factor(combined$ExterQual, order = TRUE, levels = encoding_levels)
combined$ExterCond <- factor(combined$ExterCond, order = TRUE, levels = encoding_levels)
combined$HeatingQC <- factor(combined$HeatingQC, order = TRUE, levels = encoding_levels)
combined$PavedDrive <- factor(combined$PavedDrive, order = TRUE, levels = c('N','P','Y'))
misscounts <- sapply(combined,function(x) sum(is.na(x)))
missmap(combined, main = "Missing values")
anyNA(combined)
num_vars <- which(sapply(combined,is.numeric))
factor_vars <- which(sapply(combined,is.factor))
cat('numeric variables: ', length(num_vars),' and categorical variables: ',length(factor_vars),'\n')
str(combined)
write_csv(combined, "../data/processed/clean_data.csv")
num_vars <- which(sapply(combined,is.numeric))
factor_vars <- which(sapply(combined,is.factor))
cat('numeric variables: ', length(num_vars),' and categorical variables: ',length(factor_vars),'\n')
str(combined)
write.csv(combined, "../data/processed/clean_data.csv")
